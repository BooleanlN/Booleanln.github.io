---
title: mysql_5_引擎的选择
date: 2019-03-27 09:10:54
tags:
- mysql
---

### mysql_5_引擎的选择

| 特点           | MyISAM | InnoDB | MEMORY | MERGE | NDB  |
| -------------- | ------ | ------ | ------ | ----- | ---- |
| 存储限制       | √      | 64TB   | √      |       | √    |
| 事务安全       |        | √      |        |       |      |
| 锁机制         | 表锁   | 行锁   | 表锁   | 表锁  | 行锁 |
| B树索引        | √      | √      | √      | √     | √    |
| 哈希索引       |        |        | √      |       | √    |
| 全文索引       | √      |        |        |       |      |
| 集群索引       |        | √      |        |       |      |
| 数据缓存       |        | √      | √      |       | √    |
| 索引缓存       | √      | √      | √      | √     | √    |
| 数据可压缩     | √      |        |        |       |      |
| 空间使用       | 低     | 高     | N/A    | 低    | 低   |
| 内存使用       | 低     | 高     | 中等   | 低    | 高   |
| 批量插入的速度 | 高     | 低     | 高     | 高    | 高   |
| 支持外键       |        | √      |        |       |      |

<!--more-->

事务安全：

事务是访问并且可能更新数据库中各种数据项的一个程序执行单元，多条sql语句执行时，要么全部执行成功，要么全部不执行

事务特性：ACID，原子性，一致性，隔离性，持久性

```mysql
start transaction;
select * from salary;
rollback;
commit;
```

事务安全性问题：

- 脏读：一个事务读到另外一个事务未提交的数据
- 不可重复读：一个事务读取同一条数据，多次读取结果不同
- 幻读：一个事务读取了另一个事务新插入或删除的数据

锁机制：

乐观锁：认为操作不会导致冲突，执行操作后，再进行判断是否有冲突

悲观锁：认为操作会出现数据冲突，每次操作时，都要通过获取锁才能进行操作

共享锁（读锁）：多个事务对于同一个数据可以共享一把锁，都可以访问，但只能读不能修改

排他锁（写锁）：排他锁就是不能与其他锁共存

```mysql
begin;
select * from salary where userid = 2 lock in share mode;
commit;
begin;
select * from salary where userid = 2 for update;
commit;
```

