---
title: 组件间通信
date: 2019-06-14 17:36:20
tags:
- vue
---

### 组件通信

##### 父子间通信

父组件向子组件传递信息，通过`prop`

子组件向父组件传递信息，通过`this.$emit`触发自定义事件

```vue
<template>
  <div>
    {{title}}
    <child @changeName="changeName" :toChildProp="passData"></child>
  </div>
</template>
<script>
export default {
  name: 'test1',
  data () {
    return {
      title: '组件1',
      passData: '测试'
    }
  },
  methods: {
    changeName (name) {
      this.title = name
      console.log(name)
    }
  },
  components: {
    child: {
      template: '<button @click="componentInfo">测试父子通信</button>',
      methods: {
        componentInfo () {
          this.$emit('changeName', '父子通信')
        }
      },
      props: {
        toChildProp: {
          type: String,
          default: '默认值'
        }
      }
    }
  }
}
</script>
```

<!--more -->

##### 非父子组件通信

非父子组件间通信可以使用中央事件总线的方式，即创建一个空的Vue实例，作为通信的中转站

*组件1*

```vue
<template>
  <div>
    <p>{{title}}</p>
    <el-button @click="changeTitle">测试</el-button>
  </div>
</template>

<script>
export default {
  name: 'test1',
  data () {
    return {
      title: '组件1'
    }
  },
  methods: {
      // bus.$emit触发事件
    changeTitle () {
      this.bus.$emit('toChangeTitle', '首页')
    }
  }
}
</script>
```

*组件2*

```vue
<template>
  <el-button>{{foot}}</el-button>
</template>

<script>
export default {
  name: 'test2',
  data () {
    return {
      foot: '组件2'
    }
  },
  mounted () {
    // bus.$on监听触发的事件
    this.bus.$on('toChangeTitle', function (title) {
      console.log(title)
    })
  }
}
</script>
```

*main*.js

```
let bus = new Vue()
Vue.prototype.bus = bus
/* eslint-disable no-new */
new Vue({
  el: '#app',
  router,
  components: { App },
  template: '<App/>'
})
```

